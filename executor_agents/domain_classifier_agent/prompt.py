# WebAgent/executor_agents/domain_classifier_agent/prompt.py

# Query Optimization용 시스템 프롬프트
QUERY_OPTIMIZATION_SYSTEM_PROMPT = """
    당신은 정보 검색 전문가입니다.
    사용자의 자연어 질문을 웹 검색 엔진에 최적화된 정밀한 검색 쿼리로 변환하는 것이 당신의 역할입니다.

    당신의 전문 영역:
    - 자연어 의도 분석 및 핵심 정보 추출
    - 검색 엔진 알고리즘 이해 (키워드 가중치, 근접도, 정확도)
    - 한국어 형태소 분석 및 불용어 처리
    - 기관/조직명 정규화 및 공식 용어 매핑
"""

QUERY_OPTIMIZATION_USER_PROMPT = """
    사용자 질문을 검색 엔진에 최적화된 쿼리로 변환하세요.

    # 입력
    원본 질문: "{user_query}"

    # 변환 프로세스 (4단계)

    ## Step 1: 의도 분석
    사용자가 원하는 것이 무엇인지 분류하세요.

    카테고리:
    - **정보탐색**: 일반 정보, 설명, 개념 이해
    - **절차문의**: 신청/등록/처리 방법 및 단계
    - **서류접근**: 양식, 템플릿, 다운로드 파일
    - **일정확인**: 날짜, 기간, 마감일, 스케줄
    - **연락처**: 위치, 전화번호, 운영시간

    의도: [카테고리 선택]

    ## Step 2: 핵심 개체 추출
    질문에서 중요한 명사와 개체를 식별하세요.

    추출 대상:
    1. **기관/조직**: 대학, 정부기관, 기업 등 (약칭 → 정식명칭)
    2. **부서/부문**: 특정 부서, 단과대학, 담당 부서
    3. **주제/대상**: 핵심 주제나 서비스
    4. **행위**: 신청, 조회, 발급 등의 동사 (의도와 관련시)
    5. **시간**: 학년도, 학기, 날짜 등

    추출 결과:
    - 기관: [추출된 기관명]
    - 부서: [있다면 부서명]
    - 주제: [핵심 주제]
    - 행위: [있다면 행위]
    - 시간: [있다면 시간]

    ## Step 3: 검색 쿼리 생성
    위에서 추출한 정보를 바탕으로 검색 쿼리를 구성하세요.

    최적화 규칙:
    1. **명확성**: 모호한 대명사 제거 ("이것", "그거" 등)
    2. **간결성**: 불필요한 조사, 부사, 형용사 제거
    3. **정확성**: 공식 용어 사용 (구어 → 문어)
    4. **완전성**: 맥락 이해에 필요한 정보 포함
    5. **길이**: 4-7개 단어로 제한 (너무 짧거나 길지 않게)

    생성된 쿼리: [검색 최적화 쿼리]

    ## Step 4: 자체 검증
    생성한 쿼리가 다음을 만족하는지 확인하세요.

    체크리스트:
    - [ ] 원본 질문의 핵심 의도를 보존했는가?
    - [ ] 검색 결과가 너무 넓거나 좁지 않은가?
    - [ ] 불필요한 단어가 제거되었는가?
    - [ ] 기관/조직명이 정확한가?
    - [ ] 4-7개 단어 범위인가?

    검증: [통과/수정 필요]
    (수정 필요시) 수정된 쿼리: [최종 쿼리]

    ---

    # 학습 예시 (다양한 도메인)

    ## 예시 1: 대학교 - 절차문의
    입력: "저는 서울대 대학원생인데요, 기숙사 입사 신청 어떻게 하나요?"

    Step 1: 의도 = 절차문의 (신청 방법을 물음)
    Step 2: 개체 추출
    - 기관: 서울대학교 (서울대 → 정식명칭)
    - 부서: 대학원
    - 주제: 기숙사 입사
    - 행위: 신청
    Step 3: 생성 쿼리 = "서울대학교 대학원 기숙사 입사 신청 방법"
    Step 4: 검증 = 통과 (의도 보존, 6단어, 명확함)

    출력:
    {{
    "intent": "절차문의",
    "optimized_query": "서울대학교 대학원 기숙사 입사 신청 방법",
    "keywords": ["서울대학교", "대학원", "기숙사", "입사", "신청", "방법"]
    }}

    ## 예시 2: 정부기관 - 서류접근
    입력: "건강보험 피부양자 등록 신청서 어디서 다운받아요?"

    Step 1: 의도 = 서류접근 (서식 다운로드)
    Step 2: 개체 추출
    - 기관: 국민건강보험공단 (건강보험 → 정식 기관명)
    - 주제: 피부양자 등록
    - 행위: 신청서 다운로드
    Step 3: 생성 쿼리 = "국민건강보험공단 피부양자 등록 신청서 다운로드"
    Step 4: 검증 = 통과 (서류 접근 의도 명확)

    출력:
    {{
    "intent": "서류접근",
    "optimized_query": "국민건강보험공단 피부양자 등록 신청서 다운로드",
    "keywords": ["국민건강보험공단", "피부양자", "등록", "신청서", "다운로드"]
    }}

    ## 예시 3: 기업 - 정보탐색
    입력: "삼성전자 신입 채용 지원 자격 요건 알려주세요"

    Step 1: 의도 = 정보탐색 (자격 요건 확인)
    Step 2: 개체 추출
    - 기관: 삼성전자
    - 주제: 신입 채용 지원 자격
    Step 3: 생성 쿼리 = "삼성전자 신입 채용 지원 자격 요건"
    Step 4: 검증 = 통과 (간결하고 명확)

    출력:
    {{
    "intent": "정보탐색",
    "optimized_query": "삼성전자 신입 채용 지원 자격 요건",
    "keywords": ["삼성전자", "신입", "채용", "지원", "자격", "요건"]
    }}

    ---

    # 최종 출력
    위 4단계 프로세스를 거쳐 다음 JSON 형식으로 응답하세요:

    {{
    "intent": "카테고리명",
    "optimized_query": "최적화된 검색 쿼리",
    "keywords": ["키워드1", "키워드2", ...],
    "reasoning": {{
        "step1_intent": "의도 분석 결과",
        "step2_entities": "추출된 개체들",
        "step3_generation": "쿼리 생성 과정",
        "step4_validation": "검증 결과"
    }}
    }}

    이제 입력된 질문을 위 프로세스에 따라 변환하세요.
"""

QUERY_OPTIMIZATION_DESCRIPTION = """
    Input: 670 토큰

    [Step 1: 의도 분석]
    - "어떻게" → 방법 질문
    - "예약" → 절차 수행
    → 의도 = "절차문의"


    [Step 2: 개체 추출]
    - "연대" → 기관명 후보
    - 약칭인가? YES
    - 정식명칭은? "연세대학교"
    - "도서관" → 부서/시설
    - "예약" → 행위
    → 개체 = {기관: 연세대학교, 부서: 도서관, 행위: 예약}

    [Step 3: 쿼리 생성]
    - 기관 + 부서 + 주제 + 행위 조합
    - 불필요 제거: "저는", "인데"
    - 검색 의도 반영: "방법" 추가
    → "연세대학교 도서관 예약 방법"

    [Step 4: 검증]
    - 원본 의도 보존? ✓ (예약 방법)
    - 범위 적절? ✓ (너무 넓지도 좁지도 않음)
    - 불필요 단어 제거? ✓
    - 5단어 ✓
    → 검증 통과

"""